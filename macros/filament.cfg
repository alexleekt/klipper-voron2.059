[gcode_macro SERVICE_EXTRUDE]
default_parameter_S=240
default_parameter_E=100
default_parameter_F=100
gcode:
    notify_acknowledge
    SAVE_GCODE_STATE
    M104 S{S}       ; set hotend temperature
    M109 S{S}       ; wait for hotend temperature
    G92 E0          ; zero the extruded length
    G0 E{E} F{F}    ; extrude
    RESTORE_GCODE_STATE

[gcode_macro RETRACT_FILAMENT_TO_PARK]
gcode:
    SAVE_GCODE_STATE
    M83 ; use relative distances for extrusion
    G0 E-125 F2400
    RESTORE_GCODE_STATE

[gcode_macro EXTRUDE_FILAMENT_TO_NOZZLE]
gcode:
    SAVE_GCODE_STATE
    M83 ; use relative distances for extrusion
    G0 E124 F1500
    RESTORE_GCODE_STATE

[gcode_macro MEASURE_FILAMENT]
gcode:
    service_extrude E=100

[gcode_macro LOAD_FILAMENT]
gcode:
    service_extrude E=820 F=1500

[gcode_macro UNLOAD_FILAMENT]
gcode:
    service_extrude E=-1000 F=2100
    M84 ; disable steppers

[gcode_macro NOZZLE_SCRUB]
gcode:
    SAVE_GCODE_STATE
    M117 Nozzle Scrub!
    G0 Z12 X130 Y356 F21000
    G0 X70 F15000
    G0 X130 F10000
    G0 Z10 F5000
    G0 X70 F21000
    G0 X175 Y350 F21000
    M117
    RESTORE_GCODE_STATE
